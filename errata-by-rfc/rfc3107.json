[
  {
    "errata_id": "2319",
    "doc-id": "RFC3107",
    "errata_status_code": "Rejected",
    "errata_type_code": "Technical",
    "section": "5",
    "orig_text": "\"A BGP speaker should not advertise this capability to another BGP speaker unless there is a Label Switched Path (LSP) between the two speakers.\"\r\n",
    "correct_text": "\"An eBGP speaker should not advertise this capability to another eBGP speaker unless there is a Label Switched Path (LSP) or layer two interface between the two speakers.\"\r\n\r\nOr just remove completely that sentence.",
    "notes": "1) :s/BGP/eBGP\r\nAn iBGP router should be able to set up an internal BGP session for AFI 1 / SAFI 4 toward a Route Reflector even if the Route Reflector is not capabble of forwarding MPLS packets (This case is even described in the section 2 of the RFC)\r\n\r\n2) + layer two interface\r\nIf both router are connected by a direct (sub)interface, they should be able to exchange MPLS packets even if there is no LSP between them.\r\n\r\n3) Remove the sentence\r\nAFAIK, the point is now better addressed by draft-ietf-idr-bgp-bestpath-selection-criteria-01.txt\n --VERIFIER NOTES-- \nAfter discussions with the document author on the MPLS mailing list:\r\n\r\n- The EBGP/IBGP distinction is not relevant here, as this does not properly\r\n  capture the notion of whether a BGP speaker is in the data path.\r\n \r\n- The ability to send an MPLS packet from one router to another does not\r\n  necessarily depend on there being either a sequence of MPLS routers\r\n  between them or on there being an L2 connection between them.  There might\r\n  be an L3 tunnel, for example.\r\n\r\nFurthermore, we feel that no confusion has arisen as the result of the current text so that there is no harm in leaving it as it stands.",
    "submit_date": "2010-07-07",
    "submitter_name": "Bruno Decraene",
    "verifier_id": "119",
    "verifier_name": "Adrian Farrel",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "4497",
    "doc-id": "RFC3107",
    "errata_status_code": "Verified",
    "errata_type_code": "Technical",
    "section": "2",
    "orig_text": "Label distribution can be piggybacked in the BGP Update message by\r\n   using the BGP-4 Multiprotocol Extensions attribute [RFC 2283].",
    "correct_text": "Label distribution can be piggybacked in the BGP Update message by\r\n   using the BGP-4 Multiprotocol Extensions attribute\r\ndefined in RFC 2858 [BGP-MP].",
    "notes": "No reference [RFC 2283] in Reference section of RFC 3107. The reference is called [BGP-MP].",
    "submit_date": "2015-10-13",
    "submitter_name": "Alexander Okonnikov",
    "verifier_id": "149",
    "verifier_name": "Deborah Brungard",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "4498",
    "doc-id": "RFC3107",
    "errata_status_code": "Verified",
    "errata_type_code": "Technical",
    "section": "3",
    "orig_text": "   The label(s) specified for a particular route (and associated with\r\n   its address prefix) must be assigned by the LSR which is identified\r\n   by the value of the Next Hop attribute of the route.\r\n\r\n   When a BGP speaker redistributes a route, the label(s) assigned to\r\n   that route must not be changed (except by omission), unless the\r\n   speaker changes the value of the Next Hop attribute of the route.",
    "correct_text": "   The label(s) specified for a particular route (and associated with\r\n   its address prefix) must be assigned by the LSR which is identified\r\n   by the value of the Network Address of Next Hop field of\r\n   MP_REACH_NLRI attribute of the route.\r\n\r\n   When a BGP speaker redistributes a route, the label(s) assigned to\r\n   that route must not be changed (except by omission), unless the\r\n   speaker changes the value of the Network Address of Next Hop field of\r\n   MP_REACH_NLRI attribute of the route.",
    "notes": "Next Hop address for labeled routes is conveyed within MP_REACH_NLRI attribute.",
    "submit_date": "2015-10-13",
    "submitter_name": "Alexander Okonnikov",
    "verifier_id": "149",
    "verifier_name": "Deborah Brungard",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "4499",
    "doc-id": "RFC3107",
    "errata_status_code": "Rejected",
    "errata_type_code": "Technical",
    "section": "3",
    "orig_text": "   A BGP speaker can withdraw a previously advertised route (as well as\r\n   the binding between this route and a label) by either (a) advertising\r\n   a new route (and a label) with the same NLRI as the previously\r\n   advertised route, or (b) listing the NLRI of the previously\r\n   advertised route in the Withdrawn Routes field of an Update message.\r\n   The label information carried (as part of NLRI) in the Withdrawn\r\n   Routes field should be set to 0x800000.  (Of course, terminating the\r\n   BGP session also withdraws all the previously advertised routes.)\r\n",
    "correct_text": "   A BGP speaker can withdraw a previously advertised route (as well as\r\n   the binding between this route and a label) by either (a) advertising\r\n   a new route (and a label) with the same NLRI as the previously\r\n   advertised route, or (b) listing the NLRI of the previously\r\n   advertised route in the Withdrawn Routes field of\r\n   an MR_UNREACH_NLRI attribute of an Update message.\r\n   The label information carried (as part of NLRI) in the Withdrawn\r\n   Routes field should be set to 0x000001.  (Of course, terminating the\r\n   BGP session also withdraws all the previously advertised routes.)\r\n",
    "notes": "1. Labeled routes are withdrawn by virtue of MR_UNREACH_NLRI attribute.\r\n2. Label value should be set to 0x00000 with BoS=1.  Value 0x800000 was carried from draft, where BoS was high-order bit.\n --VERIFIER NOTES-- \n  Rejected as potential to cause interoperability issues.",
    "submit_date": "2015-10-13",
    "submitter_name": "Alexander Okonnikov",
    "verifier_id": "149",
    "verifier_name": "Deborah Brungard",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "4500",
    "doc-id": "RFC3107",
    "errata_status_code": "Rejected",
    "errata_type_code": "Technical",
    "section": "5",
    "orig_text": "   A BGP speaker that is capable of handling multiple routes to a\r\n   destination (as described above) should use the Capabilities Optional\r\n   Parameter, as defined in [BGP-CAP], to inform its peers about this\r\n   capability.  The value of this capability is 4.",
    "correct_text": "   A BGP speaker that is capable of handling multiple routes to a\r\n   destination (as described above) should use the Capabilities Optional\r\n   Parameter, as defined in [BGP-CAP], to inform its peers about this\r\n   capability.  This capability is advertised using the Capability Code\r\n   4 and Capability Length 0.",
    "notes": "To remove confusion what word value means - Capability Value or value of Capability Code.\r\nAlso, format of multiple routes capability is not described, so length = 0 is assumed.\n --VERIFIER NOTES-- \n   ",
    "submit_date": "2015-10-13",
    "submitter_name": "Alexander Okonnikov",
    "verifier_id": "149",
    "verifier_name": "Deborah Brungard",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "4582",
    "doc-id": "RFC3107",
    "errata_status_code": "Held for Document Update",
    "errata_type_code": "Technical",
    "section": "GLOBAL",
    "orig_text": "[... section 3: ...]\r\n   A BGP speaker can withdraw a previously advertised route (as well as\r\n   the binding between this route and a label) by either (a) advertising\r\n   a new route (and a label) with the same NLRI as the previously\r\n   advertised route, or (b) listing the NLRI of the previously\r\n   advertised route in the Withdrawn Routes field of an Update message.\r\n   The label information carried (as part of NLRI) in the Withdrawn\r\n   Routes field should be set to 0x800000.  (Of course, terminating the\r\n   BGP session also withdraws all the previously advertised routes.)\r\n\r\n4. Advertising Multiple Routes to a Destination\r\n\r\n   A BGP speaker may maintain (and advertise to its peers) more than one\r\n   route to a given destination, as long as each such route has its own\r\n   label(s).\r\n\r\n   The encoding described above allows a single BGP Update message to\r\n   carry multiple routes, each with its own label(s).\r\n\r\n   In the case where a BGP speaker advertises multiple routes to a\r\n   destination, if a route is withdrawn, and a label(s) is specified at\r\n   the time of withdrawal, only the corresponding route with the\r\n   corresponding label is withdrawn.  If a route is withdrawn, and no\r\n   label is specified at the time of withdrawal, then only the\r\n   corresponding unlabeled route is withdrawn; the labeled routes are\r\n   left in place.\r\n[...]",
    "correct_text": "-- ALTERNATE 1: require label value --\r\n\r\n   A BGP speaker can withdraw a previously advertised route by either\r\n   (a) advertising a new route with the same NLRI (including label) as\r\n   the previously advertised route, or (b) listing the NLRI of the\r\n   previously advertised route in the Withdrawn Routes field of an\r\n   Update message.  The label information carried (as part of NLRI) in\r\n   the Withdrawn Routes field MUST be set to the value previously\r\n   announced.  (Of course, terminating the BGP session also withdraws\r\n   all the previously advertised routes.)\r\n\r\n   The binding between route and label cannot be updated to change the\r\n   label without withdrawing the old label and sending an update with\r\n   the new label.\r\n\r\n[keep section 4 unchanged]\r\n\r\n-- ALTERNATE 2: drop multiple label support --\r\n\r\n   A BGP speaker can withdraw a previously advertised route (as well as\r\n   the binding between this route and a label) by either (a) advertising\r\n   a new route (and a label) with the same prefix as the previously\r\n   advertised route, or (b) listing the NLRI of the previously\r\n   advertised route in the Withdrawn Routes field of an Update message.\r\n   The label information carried (as part of NLRI) in the Withdrawn\r\n   Routes field should be set to 0x800000.  (Of course, terminating the\r\n   BGP session also withdraws all the previously advertised routes.)\r\n\r\n[remove section 4, remove capability \"4\" in section 5]\r\n\r\n-- ALTERNATE 3: clarify implications of capability \"4\" --\r\n\r\n[optionally, change section 3:]\r\n   The label information carried (as part of NLRI) in the Withdrawn\r\n   Routes field SHOULD be set to the value previously announced.\r\n\r\n[insert section 5.1:]\r\n5.1. Implications of Multiple Routes Capability\r\n\r\n   Implementing the \"multiple routes\" capability introduced above\r\n   slightly changes the processing of update and withdraw messages to\r\n   requiring an exact match on the label, i.e. including it in NLRI\r\n   comparisons.\r\n\r\n   To ensure interoperability, an implementation that has this\r\n   capability SHOULD NOT send updates with different label values on a\r\n   session whose peer does not advertise the capability.  The peer would\r\n   in this case only hold the latest update, possibly introducing label\r\n   oscillations.  Further, the implementation MUST process incoming\r\n   updates and withdraws on such sessions as if their labels were\r\n   wildcards, removing any previous routes with the same prefix.  It\r\n   MUST NOT hold the same prefix with any but the last seen label value\r\n   on these sessions.\r\n",
    "notes": "This issue was previously discussed in\r\nhttps://osdir.com/ml/ietf.idr/2004-06/msg00010.html\r\nhttps://osdir.com/ml/ietf.idr/2004-06/msg00018.html\r\n\r\nSections 3 and 4 are inherently conflicting. The conflict is:\r\n\r\nSection 3 states a withdraw \"should\" be sent with a null label/BoS=1. This means it's not possible to withdraw a specific labeled route, instead all routes with the given prefix would need to be withdrawn. However, section 4 specifies exact-match behavior for processing updates and withdraws.\r\n\r\nAlso, the Section 3 text is semantically/editorially wrong in itself, saying (shortened) \"withdraw [...] binding [... by] new route (and a label) with the same NLRI\".  However, the label is part of the NLRI; an update with the same NLRI could thus not withdraw the binding, only possibly cause it to not be selected as best path anymore by updating attributes.\r\n\r\nI have not checked what other implementations do; Quagga (which only implements this as route reflector):\r\n- does not implement SAFI 4, but applies the behavior on SAFI 128 (VPN)\r\n- does not advertise capability 4\r\n- excludes the label value from all comparisons\r\n- will only keep the last label value received\r\n- will set the label on withdraws to all zeroes (ignoring the recommended value)\r\n\r\nNote that, as with Quagga, this also affects BGP-VPN implementations since these essentially inherit the behavior. Also note that the \"Multiple Routes Capability\" is global over all AFI/SAFI pairs.\r\n\r\n\r\nP.S.: Out of curiosity / for IDR mailing list: for anyone implementing 3107 or 4364: does your implementation include/advertise the \"multiple routes\" capability?",
    "submit_date": "2016-01-06",
    "submitter_name": "David Lamparter",
    "verifier_id": "149",
    "verifier_name": "Deborah Brungard",
    "update_date": "2019-09-10 09:09:03"
  }
]
