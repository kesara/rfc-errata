[
  {
    "errata_id": "1372",
    "doc-id": "RFC4757",
    "errata_status_code": "Verified",
    "errata_type_code": "Technical",
    "section": "7.3",
    "orig_text": " // Generate checksum of message -\r\n //  SGN_CKSUM + Token.Confounder\r\n //   Key derivation salt = 15\r\n\r\n Sgn_Cksum = MD5((int32)15, Token.Header,\r\n                Token.Confounder);\r\n\r\n",
    "correct_text": " // Generate checksum of message -\r\n //  SGN_CKSUM + Token.Confounder\r\n //   Key derivation salt = 13\r\n\r\n Sgn_Cksum = MD5((int32)13, Token.Header,\r\n                Token.Confounder);\r\n\r\n",
    "notes": "The final RFC appears to have cut-and-paste typo regarding the salt value used when generating the checksum for a WRAP token.  The value used for a MIC token is 15, the value used for a WRAP token is 13.\r\n\r\nLove Hörnquist Åstrand <lha@kth.se> pointed out that an earlier draft shows the values actually in use:\r\n\r\nhttp://tools.ietf.org/html/draft-brezak-win2k-krb-rc4-hmac-02",
    "submit_date": "2008-03-14",
    "submitter_name": "Kevin Coffman",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "1646",
    "doc-id": "RFC4757",
    "errata_status_code": "Verified",
    "errata_type_code": "Technical",
    "section": "7.2 7.3",
    "orig_text": "                           Kseq = HMAC(Kss, \"fortybits\", (int32)0);\r\n                                        // len includes terminating null\r\n                           memset(Kseq+7, 0xab, 7)",
    "correct_text": "                           Kseq = HMAC(Kss, \"fortybits\", (int32)0);\r\n                                        // len includes terminating null\r\n                           memset(Kseq+7, 0xab, 9)",
    "notes": "applies both to section 7.2 and 7.3, confirmed by Larry Zhu",
    "submit_date": "2008-12-29",
    "submitter_name": "Luke Howard",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "1647",
    "doc-id": "RFC4757",
    "errata_status_code": "Verified",
    "errata_type_code": "Editorial",
    "section": "7.2 and 7.3",
    "orig_text": "In 7.2:\r\n\r\nif (exportable)\r\n                   {\r\n                           Kseq = HMAC(Kss, \"fortybits\", (int32)0);\r\n                                        // len includes terminating null\r\n                           memset(Kseq+7, 0xab, 7)\r\n                   }\r\n\r\nIn 7.3:\r\n \r\nif (exportable)\r\n                   {\r\n\r\n                           Kcrypt = HMAC(Klocal, \"fortybits\", (int32)0);\r\n                                       // len includes terminating null\r\n                           memset(Kcrypt+7, 0xab, 7);\r\n                   }\r\n\r\nAgain in 7.3:\r\n\r\nif (exportable)\r\n                   {\r\n                           Kseq = HMAC(Kss, \"fortybits\", (int32)0);\r\n                                       // len includes terminating null\r\n                           memset(Kseq+7, 0xab, 7)\r\n                   }",
    "correct_text": "In 7.2:\r\n\r\nif (export)\r\n                   {\r\n                           Kseq = HMAC(Kss, \"fortybits\", (int32)0);\r\n                                        // len includes terminating null\r\n                           memset(Kseq+7, 0xab, 7)\r\n                   }\r\n\r\nIn 7.3:\r\n \r\nif (export)\r\n                   {\r\n\r\n                           Kcrypt = HMAC(Klocal, \"fortybits\", (int32)0);\r\n                                       // len includes terminating null\r\n                           memset(Kcrypt+7, 0xab, 7);\r\n                   }\r\n\r\nAgain in 7.3:\r\n\r\nif (export)\r\n                   {\r\n                           Kseq = HMAC(Kss, \"fortybits\", (int32)0);\r\n                                       // len includes terminating null\r\n                           memset(Kseq+7, 0xab, 7)\r\n                   }",
    "notes": "misnamed \"export\" argument  .                                                   Larry Zhu confirmed this issue\r\n\r\nSean Turner add (as pointed out by Magnus Nystrom) that there were actually three exportable/export replacements needed: 1 in Section 7.2 and two in Section 7.3.",
    "submit_date": "2008-12-31",
    "submitter_name": "Ganga Mahesh Siddem",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "1648",
    "doc-id": "RFC4757",
    "errata_status_code": "Rejected",
    "errata_type_code": "Technical",
    "section": "7.3",
    "orig_text": "Kcrypt = HMAC(Klocal, \"fortybits\", (int32)0);\r\n// len includes terminating null\r\n\r\nKseq = HMAC(Kss, \"fortybits\", (int32)0);\r\n// len includes terminating null\r\n",
    "correct_text": "Kcrypt = HMAC(Klocal,(int32)0, \"fortybits\");\r\n// len includes terminating null\r\n\r\nKseq = HMAC(Kss, (int32)0,\"fortybits\");\r\n// len includes terminating null\r\n",
    "notes": "Larry Zhu confirmed this issue.Misordered arguments  in HMAC function.\n --VERIFIER NOTES-- \nI checked with Magnus Nystrom.  He said their implementation is equal to the RFC.\r\n",
    "submit_date": "2008-12-31",
    "submitter_name": "Ganga Mahesh Siddem",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "1651",
    "doc-id": "RFC4757",
    "errata_status_code": "Verified",
    "errata_type_code": "Editorial",
    "section": "7.3",
    "orig_text": "// new encryption key salted with seq\r\n  Kcrypt = HMAC(Kcrypt, (int32)seq);\r\n\r\n\r\n",
    "correct_text": "// new encryption key salted with seq\r\n  Kcrypt = HMAC(Kcrypt, (int32)seq_num);\r\n",
    "notes": "misnamed \"seq\" argument in HMAC function .",
    "submit_date": "2009-01-10",
    "submitter_name": "Ganga Mahesh Siddem",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "1674",
    "doc-id": "RFC4757",
    "errata_status_code": "Verified",
    "errata_type_code": "Technical",
    "section": "7.3",
    "orig_text": "                   if (encrypt)\r\n                           RC4(Kcrypt, Token.Confounder);\r\n\r\n                   // Sum the data buffer\r\n\r\n                   Sgn_Cksum += MD5(data);         // Append to checksum\r\n\r\n                   // Encrypt the data (if encrypting)\r\n\r\n                   if (encrypt)\r\n                           RC4(Kcrypt, data);\r\n\r\n",
    "correct_text": "                   // Sum the data buffer\r\n\r\n                   Sgn_Cksum += MD5(data);         // Append to checksum\r\n\r\n                   // Encrypt the  Confounder + data (if encrypting)\r\n\r\n                   tmp=concat(Token.Confounder,data);\r\n\r\n                   if (encrypt)\r\n                           RC4(Kcrypt, tmp); /* tmp=Confounder + data */\r\n               \r\n                   memcpy(Token.Confounder,tmp,8);\r\n\r\n                   memcpy(data,tmp+8,(tmp.len-8));             \r\n",
    "notes": "Notes : 1.Verified RC4 Encryption and Decryption on (Token.Confounder+Data) with Kcrypt key .\r\n2.Verified  RC4(K,x+y) !=RC4(K,x);RC4(K,y)\r\n3.Reporting this issue after Larry's Feedback.",
    "submit_date": "2009-01-30",
    "submitter_name": "Ganga Mahesh Siddem",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "1675",
    "doc-id": "RFC4757",
    "errata_status_code": "Verified",
    "errata_type_code": "Technical",
    "section": "7.3",
    "orig_text": "                 // Create the sequence number\r\n\r\n                   if (direction == sender_is_initiator)\r\n                   {\r\n                           memset(&Token.SEND_SEQ[4], 0xff, 4)\r\n                   }\r\n                   else if (direction == sender_is_acceptor)\r\n                   {\r\n                           memset(&Token.SEND_SEQ[4], 0, 4)\r\n                   }\r\n\r\n",
    "correct_text": "                                            // Create the sequence number\r\n\r\n                   if (direction == sender_is_initiator)\r\n                   {\r\n                           memset(&Token.SEND_SEQ[4], 0, 4)\r\n                   }\r\n                   else if (direction == sender_is_acceptor)\r\n                   {\r\n                           memset(&Token.SEND_SEQ[4], 0xff, 4)\r\n                   }\r\n",
    "notes": "SEND_SEQ values are interchanged .",
    "submit_date": "2009-01-30",
    "submitter_name": "Ganga Mahesh Siddem",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "2067",
    "doc-id": "RFC4757",
    "errata_status_code": "Rejected",
    "errata_type_code": "Technical",
    "section": "7.3",
    "orig_text": "// Encrypt the data (if encrypting)\r\n\r\n                   if (encrypt)\r\n                           RC4(Kcrypt, data);\r\n\r\n                   // Save first 8 octets of HMAC Sgn_Cksum\r\n\r\n                   Sgn_Cksum = HMAC(Ksign, Sgn_Cksum);\r\n                   memcpy(Token.SGN_CKSUM, Sgn_Cksum, 8);\r\n",
    "correct_text": "// Encrypt the data (if encrypting)\r\n\r\n                   if (encrypt)\r\n                           RC4(Kcrypt, data);\r\n\r\n                    // Sum the padding buffer\r\n \r\n                   Sgn_Cksum += MD5(padding);\r\n\r\n                   // Encrypt the padding (if encrypting)\r\n\r\n                   if (padding)\r\n                           RC4(Kcrypt, padding);\r\n\r\n                  // Save first 8 octets of HMAC Sgn_Cksum\r\n\r\n                   Sgn_Cksum = HMAC(Ksign, Sgn_Cksum);\r\n                   memcpy(Token.SGN_CKSUM, Sgn_Cksum, 8);\r\n",
    "notes": "WRAP missing padding\n --VERIFIER NOTES-- \nTurns out padding is already included in data, so Errata 1674, which I just approved, covers this.  I verified this with Magnus Nystrom.",
    "submit_date": "2010-03-05",
    "submitter_name": "Michiko Short",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "2562",
    "doc-id": "RFC4757",
    "errata_status_code": "Verified",
    "errata_type_code": "Technical",
    "section": "3",
    "orig_text": "9.  TGS-REP encrypted part (includes application session key),\r\n          encrypted with the TGS authenticator subkey (T=8)\r\n\r\n",
    "correct_text": "9.  TGS-REP encrypted part (includes application session key),\r\n          encrypted with the TGS authenticator subkey (T=9)\r\n\r\n",
    "notes": "Typo",
    "submit_date": "2010-10-13",
    "submitter_name": "Michiko Short",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  },
  {
    "errata_id": "2628",
    "doc-id": "RFC4757",
    "errata_status_code": "Verified",
    "errata_type_code": "Technical",
    "section": "5",
    "orig_text": "nonce (edata.Confounder, 8);\r\nmemcpy (edata.Data, data);\r\nedata.Checksum = HMAC (K2, edata);",
    "correct_text": "nonce (edata.Confounder, 8);\r\nmemcpy (edata.Data, data);\r\nedata.Checksum = HMAC (K2, concat(edata.Confounder, edata.Data));",
    "notes": null,
    "submit_date": "2010-11-12",
    "submitter_name": "Matthias Schertler",
    "verifier_id": "124",
    "verifier_name": "Sean Turner",
    "update_date": "2019-09-10 09:09:03"
  }
]
